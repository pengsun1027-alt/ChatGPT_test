<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>设备巡检系统 - 消息中心</title>

		<!-- Vant 4 CSS -->
		<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/vant@4/lib/index.css" />
		<!-- Tailwind CSS -->
		<script src="https://cdn.tailwindcss.com"></script>

		<style>
			body {
				font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
				background: #f7f8fa;
			}
			.safe-bottom {
				padding-bottom: max(env(safe-area-inset-bottom), 0.75rem);
			}
		</style>
	</head>
	<body>
		<!-- 顶部导航栏 -->
		<header class="fixed inset-x-0 top-0 h-12 bg-white/90 backdrop-blur shadow-sm flex items-center justify-between px-4 z-50">
			<div class="flex items-center space-x-3">
				<button class="w-8 h-8 flex items-center justify-center" onclick="history.back()">
					<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
					</svg>
				</button>
				<h1 class="text-base font-semibold">消息中心</h1>
			</div>
			<button 
				class="px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-lg hover:bg-blue-600 active:bg-blue-700"
				onclick="markAll()"
			>
				清空未读
			</button>
		</header>

		<!-- 筛选标签栏 -->
		<div class="fixed inset-x-0 top-12 bg-white border-b border-slate-200 z-40">
			<div class="flex space-x-1 px-4 py-3 overflow-x-auto">
				<button 
					class="px-4 py-2 text-sm font-medium rounded-full bg-blue-500 text-white whitespace-nowrap"
					onclick="filter('all', this)"
				>
					全部
				</button>
				<button 
					class="px-4 py-2 text-sm font-medium rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200 whitespace-nowrap"
					onclick="filter('task', this)"
				>
					任务
				</button>
				<button 
					class="px-4 py-2 text-sm font-medium rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200 whitespace-nowrap"
					onclick="filter('repair', this)"
				>
					维修
				</button>
				<button 
					class="px-4 py-2 text-sm font-medium rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200 whitespace-nowrap"
					onclick="filter('system', this)"
				>
					系统
				</button>
			</div>
		</div>

		<!-- 主要内容区域 -->
		<main class="pt-28 px-4 space-y-1" id="list">
			<!-- 任务消息 -->
			<div class="bg-white shadow-sm border-b border-slate-100 relative" data-type="task" data-unread="1">
				<div class="p-4">
					<div class="flex items-start justify-between mb-2">
						<div class="flex items-start space-x-3 flex-1">
							<div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">
								<svg class="w-5 h-5 text-orange-600" fill="currentColor" viewBox="0 0 24 24">
									<path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
								</svg>
							</div>
							<div class="flex-1 min-w-0">
								<div class="flex items-center space-x-2">
									<h3 class="font-semibold text-slate-800 text-sm">任务逾期提醒</h3>
									<div class="unread w-2 h-2 bg-red-500 rounded-full"></div>
								</div>
								<p class="text-sm text-slate-600 mt-1">供水泵#1 电机温度逾期 10分钟</p>
								<p class="text-xs text-slate-500 mt-1">批次 2025W33，建议优先处理。</p>
							</div>
						</div>
						<div class="text-xs text-slate-500 ml-2">09:40</div>
					</div>
					<div class="flex justify-end">
						<button class="text-sm text-blue-600 font-medium hover:text-blue-700">去处理</button>
					</div>
				</div>
			</div>

			<!-- 维修消息 -->
			<div class="bg-white shadow-sm border-b border-slate-100 relative" data-type="repair" data-unread="1">
				<div class="p-4">
					<div class="flex items-start justify-between mb-2">
						<div class="flex items-start space-x-3 flex-1">
							<div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0">
								<svg class="w-5 h-5 text-red-600" fill="currentColor" viewBox="0 0 24 24">
									<path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
								</svg>
							</div>
							<div class="flex-1 min-w-0">
								<div class="flex items-center space-x-2">
									<h3 class="font-semibold text-slate-800 text-sm">维修工单指派</h3>
									<div class="unread w-2 h-2 bg-red-500 rounded-full"></div>
								</div>
								<p class="text-sm text-slate-600 mt-1">工单 #WX-20250819-001 已指派给你</p>
								<p class="text-xs text-slate-500 mt-1">轴承异响，请尽快接单处理。</p>
							</div>
						</div>
						<div class="text-xs text-slate-500 ml-2">09:20</div>
					</div>
					<div class="flex justify-end">
						<button class="text-sm text-blue-600 font-medium hover:text-blue-700">查看工单</button>
					</div>
				</div>
			</div>

			<!-- 系统消息 -->
			<div class="bg-white shadow-sm border-b border-slate-100 relative" data-type="system" data-unread="0">
				<div class="p-4">
					<div class="flex items-start justify-between mb-2">
						<div class="flex items-start space-x-3 flex-1">
							<div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
								<svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
									<path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
								</svg>
							</div>
							<div class="flex-1 min-w-0">
								<h3 class="font-semibold text-slate-800 text-sm">系统通知</h3>
								<p class="text-sm text-slate-600 mt-1">版本更新说明 V1.4.0</p>
								<p class="text-xs text-slate-500 mt-1">优化上传稳定性，新增离线草稿批量提交。</p>
							</div>
						</div>
						<div class="text-xs text-slate-500 ml-2">昨天 18:30</div>
					</div>
				</div>
			</div>

			<!-- 更多系统消息 -->
			<div class="bg-white shadow-sm border-b border-slate-100 relative" data-type="system" data-unread="0">
				<div class="p-4">
					<div class="flex items-start justify-between mb-2">
						<div class="flex items-start space-x-3 flex-1">
							<div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
								<svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 24 24">
									<path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
								</svg>
							</div>
							<div class="flex-1 min-w-0">
								<h3 class="font-semibold text-slate-800 text-sm">系统通知</h3>
								<p class="text-sm text-slate-600 mt-1">数据同步完成</p>
								<p class="text-xs text-slate-500 mt-1">设备档案、任务记录已同步至云端。</p>
							</div>
						</div>
						<div class="text-xs text-slate-500 ml-2">08-18 16:20</div>
					</div>
				</div>
			</div>

			<!-- 任务完成消息 -->
			<div class="bg-white shadow-sm border-b border-slate-100 relative" data-type="task" data-unread="0">
				<div class="p-4">
					<div class="flex items-start justify-between mb-2">
						<div class="flex items-start space-x-3 flex-1">
							<div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
								<svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 24 24">
									<path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
								</svg>
							</div>
							<div class="flex-1 min-w-0">
								<h3 class="font-semibold text-slate-800 text-sm">任务完成</h3>
								<p class="text-sm text-slate-600 mt-1">冷却塔#2 巡检任务已完成</p>
								<p class="text-xs text-slate-500 mt-1">执行人：李工，结果：正常</p>
							</div>
						</div>
						<div class="text-xs text-slate-500 ml-2">08-18 14:15</div>
					</div>
				</div>
			</div>
		</main>

		<!-- 空状态 -->
		<div class="hidden pt-24 px-4" id="empty-state">
			<div class="text-center py-16">
				<div class="w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4">
					<svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
					</svg>
				</div>
				<h3 class="text-slate-800 font-semibold mb-2">暂无消息</h3>
				<p class="text-slate-500 text-sm">当前分类下没有消息</p>
			</div>
		</div>

		<!-- Vant 4 JS -->
		<script src="https://fastly.jsdelivr.net/npm/vant@4/lib/vant.min.js"></script>
		<script>
			function markAll() {
				document.querySelectorAll('.msg[data-unread="1"] .unread').forEach((e) => e.remove());
				document.querySelectorAll('.msg[data-unread="1"]').forEach((e) => e.setAttribute('data-unread', '0'));
			}
			
			function filter(type, el) {
				// 更新按钮状态
				document.querySelectorAll('.fixed .px-4').forEach((btn) => {
					btn.className = btn.className.replace('bg-blue-500 text-white', 'bg-slate-100 text-slate-600');
				});
				el.className = el.className.replace('bg-slate-100 text-slate-600', 'bg-blue-500 text-white');
				
				// 筛选消息
				const messages = document.querySelectorAll('[data-type]');
				let visibleCount = 0;
				
				messages.forEach((m) => {
					if (type === 'all') {
						m.style.display = 'block';
						visibleCount++;
					} else {
						if (m.getAttribute('data-type') === type) {
							m.style.display = 'block';
							visibleCount++;
						} else {
							m.style.display = 'none';
						}
					}
				});
				
				// 显示/隐藏空状态
				const emptyState = document.getElementById('empty-state');
				if (visibleCount === 0) {
					emptyState.classList.remove('hidden');
					document.getElementById('list').classList.add('hidden');
				} else {
					emptyState.classList.add('hidden');
					document.getElementById('list').classList.remove('hidden');
				}
			}
		</script>
	</body>
</html>
<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>设备巡检系统 - 新建报修</title>

		<!-- Tailwind CSS -->
		<script src="https://cdn.tailwindcss.com"></script>

		<style>
			body {
				font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei',
					sans-serif;
				background: #f7f8fa;
			}
			.safe-bottom {
				padding-bottom: max(env(safe-area-inset-bottom), 0.75rem);
			}
		</style>
	</head>
	<body>
		<!-- 顶部导航栏 -->
		<header
			class="fixed inset-x-0 top-0 h-12 bg-white/90 backdrop-blur shadow-sm flex items-center justify-between px-4 z-50"
		>
			<button class="w-8 h-8 flex items-center justify-center" onclick="history.back()">
				<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
				</svg>
			</button>
			<h1 class="text-base font-semibold">新建报修</h1>
			<div class="w-8"></div>
		</header>

		<!-- 主要内容区域 -->
		<main class="mt-14 px-4 pb-20 space-y-4">
			<!-- 设备选择 -->
			<div class="bg-white rounded-lg shadow-sm p-4">
				<h3 class="font-semibold text-slate-800 mb-3">设备信息</h3>
				<div class="space-y-3">
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2"
							>设备名称 <span class="text-red-500">*</span></label
						>
						<select
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500"
							style="--tw-ring-color: #2563eb"
						>
							<option value="">请选择设备</option>
							<option value="pump1">供水泵#1</option>
							<option value="pump2">循环泵#2</option>
							<option value="fan3">风机#3</option>
							<option value="motor4">电机#4</option>
						</select>
					</div>
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2">设备位置</label>
						<input
							type="text"
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500"
							style="--tw-ring-color: #2563eb"
							value="一号厂 · 南区"
							readonly
						/>
					</div>
				</div>
			</div>

			<!-- 故障信息 -->
			<div class="bg-white rounded-lg shadow-sm p-4">
				<h3 class="font-semibold text-slate-800 mb-3">故障信息</h3>
				<div class="space-y-3">
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2"
							>优先级 <span class="text-red-500">*</span></label
						>
						<div class="flex space-x-2">
							<button
								class="px-4 py-2 border border-red-500 bg-red-50 text-red-700 rounded-full text-sm font-semibold"
								onclick="selectPriority(this, '紧急')"
							>
								紧急
							</button>
							<button
								class="px-4 py-2 border border-slate-300 text-slate-600 rounded-full text-sm font-semibold"
								onclick="selectPriority(this, '一般')"
							>
								一般
							</button>
							<button
								class="px-4 py-2 border border-slate-300 text-slate-600 rounded-full text-sm font-semibold"
								onclick="selectPriority(this, '低')"
							>
								低
							</button>
						</div>
					</div>
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2">故障类型</label>
						<select
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500"
							style="--tw-ring-color: #2563eb"
						>
							<option value="">请选择故障类型</option>
							<option value="temperature">温度异常</option>
							<option value="noise">噪音异常</option>
							<option value="vibration">振动异常</option>
							<option value="leak">泄漏</option>
							<option value="electrical">电气故障</option>
							<option value="mechanical">机械故障</option>
							<option value="other">其他</option>
						</select>
					</div>
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2"
							>故障描述 <span class="text-red-500">*</span></label
						>
						<textarea
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500 min-h-24 resize-none"
							style="--tw-ring-color: #2563eb"
							placeholder="请详细描述故障现象，包括发生时间、具体症状等"
						></textarea>
					</div>
				</div>
			</div>

			<!-- 现场图片 -->
			<div class="bg-white rounded-lg shadow-sm p-4">
				<h3 class="font-semibold text-slate-800 mb-3">现场图片</h3>
				<div class="grid grid-cols-3 gap-3" id="photoGrid">
					<button
						class="aspect-square border-2 border-dashed border-slate-300 rounded-lg flex items-center justify-center text-slate-500 hover:border-slate-400"
						onclick="addPhoto()"
					>
						<div class="text-center">
							<svg class="w-8 h-8 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M12 4v16m8-8H4"
								/>
							</svg>
							<span class="text-xs">添加图片</span>
						</div>
					</button>
				</div>
				<div class="text-xs text-slate-500 mt-2">建议上传故障现场照片，便于维修人员了解情况</div>
			</div>

			<!-- 联系信息 -->
			<div class="bg-white rounded-lg shadow-sm p-4">
				<h3 class="font-semibold text-slate-800 mb-3">联系信息</h3>
				<div class="space-y-3">
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2">报告人</label>
						<input
							type="text"
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500"
							style="--tw-ring-color: #2563eb"
							value="张三"
							readonly
						/>
					</div>
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2">联系电话</label>
						<input
							type="tel"
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500"
							style="--tw-ring-color: #2563eb"
							placeholder="请输入联系电话"
						/>
					</div>
					<div>
						<label class="block text-sm font-medium text-slate-600 mb-2">预计工时</label>
						<select
							class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500"
							style="--tw-ring-color: #2563eb"
						>
							<option value="">请选择预计工时</option>
							<option value="1">1小时</option>
							<option value="2">2小时</option>
							<option value="4">4小时</option>
							<option value="8">8小时</option>
							<option value="16">1-2天</option>
							<option value="40">1周</option>
						</select>
					</div>
				</div>
			</div>

			<!-- 技术要求 -->
			<div class="bg-white rounded-lg shadow-sm p-4">
				<h3 class="font-semibold text-slate-800 mb-3">技术要求</h3>
				<textarea
					class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:border-blue-500 min-h-20 resize-none"
					style="--tw-ring-color: #2563eb"
					placeholder="请填写具体的技术要求或维修建议（选填）"
				></textarea>
			</div>
		</main>

		<!-- 底部操作栏 -->
		<div class="fixed inset-x-0 bottom-0 bg-white/95 backdrop-blur border-t border-slate-200 safe-bottom z-50">
			<div class="px-4 py-3 flex space-x-3">
				<button
					class="flex-1 py-3 bg-slate-100 text-slate-700 font-medium rounded hover:bg-slate-200 transition-all duration-200"
				>
					保存草稿
				</button>
				<button
					class="flex-1 py-3 text-white font-semibold rounded hover:bg-blue-700 hover:-translate-y-px transition-all duration-200"
					style="background-color: #2563eb"
				>
					提交报修
				</button>
			</div>
		</div>

		<script>
			let selectedPriority = '紧急';

			function selectPriority(button, priority) {
				// 清除所有按钮的选中状态
				const buttons = button.parentNode.querySelectorAll('button');
				buttons.forEach((btn) => {
					btn.className =
						'px-4 py-2 border border-slate-300 text-slate-600 rounded-full text-sm font-semibold';
				});

				// 设置选中状态
				selectedPriority = priority;
				if (priority === '紧急') {
					button.className =
						'px-4 py-2 border border-red-500 bg-red-50 text-red-700 rounded-full text-sm font-semibold';
				} else if (priority === '一般') {
					button.className =
						'px-4 py-2 border border-yellow-500 bg-yellow-50 text-yellow-700 rounded-full text-sm font-semibold';
				} else {
					button.className =
						'px-4 py-2 border border-green-500 bg-green-50 text-green-700 rounded-full text-sm font-semibold';
				}
			}

			function addPhoto() {
				const grid = document.getElementById('photoGrid');
				const photoCount = grid.children.length - 1; // 减去添加按钮

				if (photoCount >= 6) {
					alert('最多只能添加6张图片');
					return;
				}

				// 创建图片占位元素
				const photoDiv = document.createElement('div');
				photoDiv.className =
					'aspect-square bg-slate-100 rounded-lg flex items-center justify-center text-xs text-slate-600 border border-slate-200 relative';
				photoDiv.innerHTML = `
					<span>图片${photoCount + 1}</span>
					<button class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs flex items-center justify-center" onclick="removePhoto(this)">
						×
					</button>
				`;

				// 在添加按钮之前插入
				const addButton = grid.lastElementChild;
				grid.insertBefore(photoDiv, addButton);

				console.log('添加图片');
			}

			function removePhoto(button) {
				const photoDiv = button.parentElement;
				photoDiv.remove();
			}

			// 设备选择联动
			document.querySelector('select').addEventListener('change', function (e) {
				const locationInput = document.querySelector('input[readonly]');
				const locations = {
					pump1: '一号厂 · 南区',
					pump2: '一号厂 · 北区',
					fan3: '二号厂 · 东区',
					motor4: '二号厂 · 西区',
				};
				locationInput.value = locations[e.target.value] || '';
			});
		</script>
	</body>
</html>
